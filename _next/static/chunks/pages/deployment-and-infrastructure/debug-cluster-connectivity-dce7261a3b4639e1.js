(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1614],{557:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/deployment-and-infrastructure/debug-cluster-connectivity",function(){return t(6583)}])},9369:function(e,n,t){"use strict";var a=t(5893);t(7294);let i={logo:(0,a.jsx)("span",{children:"\uD83D\uDCDA Bratislava Documentation"}),project:{link:"https://github.com/bratislava"},docsRepositoryBase:"https://github.com/bratislava/bratislava.github.io",sidebar:{defaultMenuCollapseLevel:0},footer:{text:"Department of Innovation and Technology of the City of Bratislava"},faviconGlyph:"\uD83D\uDCDA"};n.Z=i},6583:function(e,n,t){"use strict";t.r(n);var a=t(5893),i=t(2673),r=t(4376),s=t(9369);t(9966);var o=t(1151);t(5675);let l={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,o.ah)(),e.components);return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)},pageOpts:{filePath:"pages/deployment-and-infrastructure/debug-cluster-connectivity.md",route:"/deployment-and-infrastructure/debug-cluster-connectivity",headings:[{depth:1,value:"Debugging k8s cluster connectivity to an outside service",id:"debugging-k8s-cluster-connectivity-to-an-outside-service"},{depth:3,value:"Connect to proper Kubernetes cluster",id:"connect-to-proper-kubernetes-cluster"},{depth:3,value:"Check if your service is running in a pod.",id:"check-if-your-service-is-running-in-a-pod"},{depth:3,value:"Create a new debug pod with ubuntu",id:"create-a-new-debug-pod-with-ubuntu"},{depth:3,value:"Install needed debugging utilities for ubuntu",id:"install-needed-debugging-utilities-for-ubuntu"},{depth:3,value:"Clean Up",id:"clean-up"}],pageMap:[{kind:"MdxPage",name:"GINIS",route:"/GINIS"},{kind:"Meta",data:{index:"Introduction",onboarding:"Setup & Onboarding","-- Eslint --":{type:"separator"},"eslint-and-prettier":"Eslint & Prettier","-- Web development --":{type:"separator"},frontend:"Frontend",strapi:"Strapi",graphql:"GraphQL",meilisearch:"Meilisearch",openapi:"OpenAPI client","-- Backend --":{type:"separator"},GINIS:"GINIS",nestjs:"NestJS","-- DevOps --":{type:"separator"},"deployment-and-infrastructure":"Deployment & Infrastructure","monitoring-and-observability":"Monitoring & Observability","-- Projects --":{type:"separator"},"bratislava.sk":"bratislava.sk","konto.bratislava.sk":"konto.bratislava.sk","muzeumbratislava.sk":"muzeumbratislava.sk"}},{kind:"Folder",name:"deployment-and-infrastructure",route:"/deployment-and-infrastructure",children:[{kind:"MdxPage",name:"backups",route:"/deployment-and-infrastructure/backups"},{kind:"MdxPage",name:"connecting-to-kubernetes",route:"/deployment-and-infrastructure/connecting-to-kubernetes"},{kind:"MdxPage",name:"database-backups",route:"/deployment-and-infrastructure/database-backups"},{kind:"MdxPage",name:"debug-cluster-connectivity",route:"/deployment-and-infrastructure/debug-cluster-connectivity"},{kind:"MdxPage",name:"deployment-and-releases",route:"/deployment-and-infrastructure/deployment-and-releases"},{kind:"MdxPage",name:"env-vars-and-secrets",route:"/deployment-and-infrastructure/env-vars-and-secrets"},{kind:"Meta",data:{backups:"Backups","connecting-to-kubernetes":"Connecting to Kubernetes","database-backups":"Database Backups","debug-cluster-connectivity":"Debug Cluster Connectivity","deployment-and-releases":"Deployment and Releases","env-vars-and-secrets":"Env Vars and Secrets"}}]},{kind:"MdxPage",name:"eslint-and-prettier",route:"/eslint-and-prettier"},{kind:"Folder",name:"frontend",route:"/frontend",children:[{kind:"Meta",data:{components:{title:"Components"},svg:{title:"SVG setup"},captcha:{display:"hidden",title:"Captcha"},"data-fetching-listing":{title:"Data fetching & listing",display:"hidden"},"date-and-time":{title:"Date & time",display:"hidden"},fonts:{display:"hidden",title:"Fonts"},gallery:{display:"hidden",title:"Gallery"},icons:{display:"hidden",title:"Icons"},images:{display:"hidden",title:"Images"},localization:{display:"hidden",title:"Localization"},menu:{display:"hidden",title:"Menu"},"navigation-breadcrumbs":{title:"Navigation & breadcrumbs",display:"hidden"},search:{display:"hidden",title:"Search"},seo:{display:"hidden",title:"Seo"},texts:{display:"hidden",title:"Texts"}}},{kind:"MdxPage",name:"captcha",route:"/frontend/captcha"},{kind:"Folder",name:"components",route:"/frontend/components",children:[{kind:"Meta",data:{cards:{title:"Cards"},links:{display:"hidden",title:"Links"},modals:{display:"hidden",title:"Modals"},tables:{display:"hidden",title:"Tables"}}},{kind:"MdxPage",name:"cards",route:"/frontend/components/cards"},{kind:"MdxPage",name:"links",route:"/frontend/components/links"},{kind:"MdxPage",name:"modals",route:"/frontend/components/modals"},{kind:"MdxPage",name:"tables",route:"/frontend/components/tables"}]},{kind:"MdxPage",name:"components",route:"/frontend/components"},{kind:"MdxPage",name:"data-fetching-listing",route:"/frontend/data-fetching-listing"},{kind:"MdxPage",name:"date-and-time",route:"/frontend/date-and-time"},{kind:"MdxPage",name:"fonts",route:"/frontend/fonts"},{kind:"MdxPage",name:"gallery",route:"/frontend/gallery"},{kind:"MdxPage",name:"icons",route:"/frontend/icons"},{kind:"MdxPage",name:"images",route:"/frontend/images"},{kind:"MdxPage",name:"localization",route:"/frontend/localization"},{kind:"MdxPage",name:"menu",route:"/frontend/menu"},{kind:"MdxPage",name:"navigation-breadcrumbs",route:"/frontend/navigation-breadcrumbs"},{kind:"MdxPage",name:"search",route:"/frontend/search"},{kind:"MdxPage",name:"seo",route:"/frontend/seo"},{kind:"MdxPage",name:"svg",route:"/frontend/svg"},{kind:"MdxPage",name:"texts",route:"/frontend/texts"}]},{kind:"MdxPage",name:"graphql",route:"/graphql"},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"meilisearch",route:"/meilisearch"},{kind:"Folder",name:"monitoring-and-observability",route:"/monitoring-and-observability",children:[{kind:"Folder",name:"alerting",route:"/monitoring-and-observability/alerting",children:[{kind:"MdxPage",name:"contact-point",route:"/monitoring-and-observability/alerting/contact-point"},{kind:"MdxPage",name:"endpoint_alert",route:"/monitoring-and-observability/alerting/endpoint_alert"},{kind:"MdxPage",name:"grafana_alerting",route:"/monitoring-and-observability/alerting/grafana_alerting"},{kind:"MdxPage",name:"log_alert",route:"/monitoring-and-observability/alerting/log_alert"},{kind:"MdxPage",name:"resource_alert",route:"/monitoring-and-observability/alerting/resource_alert"},{kind:"Meta",data:{"contact-point":"Contact Point",endpoint_alert:"Endpoint Alert",grafana_alerting:"Grafana Alerting",log_alert:"Log Alert",resource_alert:"Resource Alert"}}]},{kind:"MdxPage",name:"grafana",route:"/monitoring-and-observability/grafana"},{kind:"Meta",data:{grafana:"Grafana"}}]},{kind:"Folder",name:"onboarding",route:"/onboarding",children:[{kind:"Meta",data:{"editor-setup":"Editor Setup","docker-setup":"Docker / Podman Setup","wsl-setup":"Windows WSL Setup","kubernetes-lens-setup":"Kubernetes & Lens Setup","postgres-setup":"Postgres Setup",other:"Other Setups","--- Workflow ---":{type:"separator"},"developer-accesses":"Developer Accesses","git-workflow":"Git Workflow"}},{kind:"MdxPage",name:"developer-accesses",route:"/onboarding/developer-accesses"},{kind:"MdxPage",name:"docker-setup",route:"/onboarding/docker-setup"},{kind:"MdxPage",name:"editor-setup",route:"/onboarding/editor-setup"},{kind:"MdxPage",name:"git-workflow",route:"/onboarding/git-workflow"},{kind:"MdxPage",name:"kubernetes-lens-setup",route:"/onboarding/kubernetes-lens-setup"},{kind:"MdxPage",name:"other",route:"/onboarding/other"},{kind:"MdxPage",name:"postgres-setup",route:"/onboarding/postgres-setup"},{kind:"MdxPage",name:"wsl-setup",route:"/onboarding/wsl-setup"}]},{kind:"MdxPage",name:"openapi",route:"/openapi"},{kind:"Folder",name:"strapi",route:"/strapi",children:[{kind:"Meta",data:{"general-concepts":"General concepts","best-practices":"Best practices","make-content-public":"Make the content public",setup:"Setup","load-strapi-db-in-local-dev":"Load DB for local development","sync-strapi-db-to-different-env":"Sync DB between deployments"}},{kind:"MdxPage",name:"best-practices",route:"/strapi/best-practices"},{kind:"MdxPage",name:"load-strapi-db-in-local-dev",route:"/strapi/load-strapi-db-in-local-dev"},{kind:"MdxPage",name:"make-content-public",route:"/strapi/make-content-public"},{kind:"MdxPage",name:"setup",route:"/strapi/setup"},{kind:"MdxPage",name:"sync-strapi-db-to-different-env",route:"/strapi/sync-strapi-db-to-different-env"}]}],flexsearch:{codeblocks:!0},title:"Debugging k8s cluster connectivity to an outside service"},pageNextRoute:"/deployment-and-infrastructure/debug-cluster-connectivity",nextraLayout:r.ZP,themeConfig:s.Z};function d(e){let n=Object.assign({h1:"h1",p:"p",a:"a",br:"br",code:"code",ol:"ol",li:"li",h3:"h3",pre:"pre",span:"span",ul:"ul"},(0,o.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"debugging-k8s-cluster-connectivity-to-an-outside-service",children:"Debugging k8s cluster connectivity to an outside service"}),"\n",(0,a.jsxs)(n.p,{children:["To debug running pods in kubernetes you can follow official guide - ",(0,a.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/debug/debug-application/debug-running-pod/",children:"https://kubernetes.io/docs/tasks/debug/debug-application/debug-running-pod/"}),".",(0,a.jsx)(n.br,{}),"\n","Following is just a small example in our local context. Let's assume you want to check if you can ping a service from the ",(0,a.jsx)(n.code,{children:"next-city-library"})," pod."]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.h3,{id:"connect-to-proper-kubernetes-cluster",children:"Connect to proper Kubernetes cluster"}),"\n",(0,a.jsxs)(n.p,{children:["In our case, we will connect to ",(0,a.jsx)(n.code,{children:"tkg-innov-dev"}),". You can follow our ",(0,a.jsx)(n.a,{href:"../onboarding/kubernetes-lens-setup",children:"Login guide"}),".\nTo verify that you are correctly connected you can run"]}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"kubectl"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"config"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"current-context"})]})})}),"\n",(0,a.jsxs)(n.p,{children:["The output should match ",(0,a.jsx)(n.code,{children:"tkg-innov-dev"}),"."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.h3,{id:"check-if-your-service-is-running-in-a-pod",children:"Check if your service is running in a pod."}),"\n",(0,a.jsx)(n.p,{children:"Run"}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"kubectl"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"get"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"pods"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--all-namespaces"})]})})}),"\n",(0,a.jsxs)(n.p,{children:["and find your desired pod and copy its name like: ",(0,a.jsx)(n.code,{children:"next-city-library-app-b868fcd5c-lj6tb"}),".",(0,a.jsx)(n.br,{}),"\n","If you are running a reasonable ",(0,a.jsx)(n.code,{children:"*nix"})," shell, you can do"]}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"kubectl"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"get"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"pods"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--all-namespaces"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"grep"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"next-city-library"'})]})})}),"\n",(0,a.jsx)(n.p,{children:"which should help with finding your POD."}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.h3,{id:"create-a-new-debug-pod-with-ubuntu",children:"Create a new debug pod with ubuntu"}),"\n",(0,a.jsx)(n.p,{children:"Now we will create a new debug pod with ubuntu, and we will attach the container to the pod so we can easily debug it.\nRun following command to create a new debug POD, which will be a exact copy of your original container (you can read more information in the official docs)"}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"kubectl"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"debug"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"next-city-library-app-b868fcd5c-lj6to"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"-it"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--namespace=bratislava-monorepo"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--image=ubuntu"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--share-processes"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--copy-to=next-city-library-app-debug"})]})})}),"\n",(0,a.jsxs)(n.p,{children:["Don't forget to update the proper pod and ",(0,a.jsx)(n.code,{children:"--copy-to"})," to the name you want. Under ",(0,a.jsx)(n.code,{children:"--copy-to"}),", you will find the running pod. This command will also attach you to newly created POD."]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.h3,{id:"install-needed-debugging-utilities-for-ubuntu",children:"Install needed debugging utilities for ubuntu"}),"\n",(0,a.jsx)(n.p,{children:"Before any installations run, you might need to run"}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"sudo"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"apt"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"update"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--yes"})]})})}),"\n",(0,a.jsx)(n.p,{children:"For debugging, you will probably need some networking tools. You can install it with these commands:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["ping: ",(0,a.jsx)(n.code,{children:"apt-get install iputils-ping"})]}),"\n",(0,a.jsxs)(n.li,{children:["nslookup: ",(0,a.jsx)(n.code,{children:"apt-get install dnsutils"})]}),"\n",(0,a.jsxs)(n.li,{children:["wget: ",(0,a.jsx)(n.code,{children:"apt install wget"})]}),"\n",(0,a.jsxs)(n.li,{children:["curl: ",(0,a.jsx)(n.code,{children:"apt install curl"})]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.h3,{id:"clean-up",children:"Clean Up"}),"\n",(0,a.jsx)(n.p,{children:"After you are done with debugging, please clean up after yourself and delete the pods that you have created and no longer need. For example you can delete our debug pod with following command"}),"\n",(0,a.jsx)(n.pre,{"data-language":"bash","data-theme":"default",children:(0,a.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,a.jsxs)(n.span,{className:"line",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"kubectl"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"delete"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"pod"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"next-city-library-app-debug"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"--namespace=bratislava-monorepo"})]})})}),"\n"]}),"\n"]})]})}n.default=(0,i.j)(l)}},function(e){e.O(0,[9774,5840,2888,179],function(){return e(e.s=557)}),_N_E=e.O()}]);