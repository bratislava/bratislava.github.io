(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3986],{1600:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/recipes/connecting-to-kubernetes",function(){return s(2636)}])},3957:function(e,n,s){"use strict";var t=s(5893);s(7294);let o={logo:(0,t.jsx)("span",{children:"\uD83D\uDCDA Bratislava Documentation"}),project:{link:"https://github.com/bratislava"},docsRepositoryBase:"https://github.com/bratislava/bratislava.github.io",footer:{text:"Department of Innovation and Technology of the City of Bratislava"},faviconGlyph:"\uD83D\uDCDA"};n.Z=o},2636:function(e,n,s){"use strict";s.r(n),s.d(n,{default:function(){return l.ZP}});var t,o=s(5893),r=s(2720),i=s(3957);s(5513);var a=s(1151);s(5675);var l=s(1235);let c={filePath:"pages/recipes/connecting-to-kubernetes.md",route:"/recipes/connecting-to-kubernetes",frontMatter:{},pageMap:[{kind:"Meta",data:{index:"Introduction","bratislava.sk":"Bratislava.sk","deployment-and-infrastructure":"Deployment and Infrastructure",graphql:"GraphQL",meilisearch:"Meilisearch",nestjs:"Nestjs",other:"Other",recipes:"Recipes",strapi:"Strapi"}},{kind:"Folder",name:"bratislava.sk",route:"/bratislava.sk",children:[{kind:"MdxPage",name:"add-new-component-to-sections",route:"/bratislava.sk/add-new-component-to-sections"},{kind:"MdxPage",name:"colors-and-themes",route:"/bratislava.sk/colors-and-themes"},{kind:"MdxPage",name:"forms-general",route:"/bratislava.sk/forms-general"},{kind:"MdxPage",name:"forms-uischema",route:"/bratislava.sk/forms-uischema"},{kind:"MdxPage",name:"forms-upload-file",route:"/bratislava.sk/forms-upload-file"},{kind:"MdxPage",name:"meilisearch-setup",route:"/bratislava.sk/meilisearch-setup"},{kind:"MdxPage",name:"react-component-structure",route:"/bratislava.sk/react-component-structure"},{kind:"Meta",data:{"add-new-component-to-sections":"Add New Component to Sections","colors-and-themes":"Colors and Themes","forms-general":"Forms General","forms-uischema":"Forms Uischema","forms-upload-file":"Forms Upload File","meilisearch-setup":"Meilisearch Setup","react-component-structure":"React Component Structure"}}]},{kind:"Folder",name:"deployment-and-infrastructure",route:"/deployment-and-infrastructure",children:[{kind:"MdxPage",name:"backups",route:"/deployment-and-infrastructure/backups"},{kind:"MdxPage",name:"database-backups",route:"/deployment-and-infrastructure/database-backups"},{kind:"MdxPage",name:"deployment",route:"/deployment-and-infrastructure/deployment"},{kind:"MdxPage",name:"grafana",route:"/deployment-and-infrastructure/grafana"},{kind:"Meta",data:{backups:"Backups","database-backups":"Database Backups",deployment:"Deployment",grafana:"Grafana"}}]},{kind:"MdxPage",name:"graphql",route:"/graphql"},{kind:"MdxPage",name:"index",route:"/",frontMatter:{sidebar_position:1}},{kind:"MdxPage",name:"meilisearch",route:"/meilisearch"},{kind:"Folder",name:"nestjs",route:"/nestjs",children:[{kind:"MdxPage",name:"Authentication",route:"/nestjs/Authentication"},{kind:"MdxPage",name:"CardWebPay",route:"/nestjs/CardWebPay"},{kind:"MdxPage",name:"Controllers",route:"/nestjs/Controllers"},{kind:"MdxPage",name:"Kubernetes",route:"/nestjs/Kubernetes"},{kind:"MdxPage",name:"Logging",route:"/nestjs/Logging"},{kind:"MdxPage",name:"Module",route:"/nestjs/Module"},{kind:"MdxPage",name:"NestJS",route:"/nestjs/NestJS",frontMatter:{sidebar_position:1}},{kind:"MdxPage",name:"OpenAPI",route:"/nestjs/OpenAPI"},{kind:"MdxPage",name:"Prisma",route:"/nestjs/Prisma"},{kind:"MdxPage",name:"ProjectStructure",route:"/nestjs/ProjectStructure"},{kind:"MdxPage",name:"RestApi",route:"/nestjs/RestApi"},{kind:"MdxPage",name:"Sentry",route:"/nestjs/Sentry"},{kind:"MdxPage",name:"Services",route:"/nestjs/Services"},{kind:"MdxPage",name:"Testing",route:"/nestjs/Testing"},{kind:"Meta",data:{Authentication:"Authentication",CardWebPay:"Cardwebpay",Controllers:"Controllers",Kubernetes:"Kubernetes",Logging:"Logging",Module:"Module",NestJS:"Nestjs",OpenAPI:"Openapi",Prisma:"Prisma",ProjectStructure:"Projectstructure",RestApi:"Restapi",Sentry:"Sentry",Services:"Services",Testing:"Testing"}}]},{kind:"Folder",name:"other",route:"/other",children:[{kind:"MdxPage",name:"developer-accesses",route:"/other/developer-accesses",frontMatter:{sidebar_position:2}},{kind:"MdxPage",name:"meetings-syncs-rituals",route:"/other/meetings-syncs-rituals",frontMatter:{sidebar_position:3}},{kind:"Meta",data:{"developer-accesses":"Developer Accesses","meetings-syncs-rituals":"Meetings Syncs Rituals"}}]},{kind:"Folder",name:"recipes",route:"/recipes",children:[{kind:"Folder",name:"alerting",route:"/recipes/alerting",children:[{kind:"MdxPage",name:"contact-point",route:"/recipes/alerting/contact-point"},{kind:"MdxPage",name:"endpoint_alert",route:"/recipes/alerting/endpoint_alert"},{kind:"MdxPage",name:"grafana_alerting",route:"/recipes/alerting/grafana_alerting",frontMatter:{sidebar_position:1}},{kind:"MdxPage",name:"log_alert",route:"/recipes/alerting/log_alert"},{kind:"MdxPage",name:"resource_alert",route:"/recipes/alerting/resource_alert"},{kind:"Meta",data:{"contact-point":"Contact Point",endpoint_alert:"Endpoint Alert",grafana_alerting:"Grafana Alerting",log_alert:"Log Alert",resource_alert:"Resource Alert"}}]},{kind:"MdxPage",name:"connecting-to-kubernetes",route:"/recipes/connecting-to-kubernetes"},{kind:"MdxPage",name:"debug-cluster-connectivity",route:"/recipes/debug-cluster-connectivity"},{kind:"MdxPage",name:"docker-setup",route:"/recipes/docker-setup"},{kind:"MdxPage",name:"editor-setup",route:"/recipes/editor-setup"},{kind:"MdxPage",name:"env-vars-and-secrets",route:"/recipes/env-vars-and-secrets"},{kind:"MdxPage",name:"git-workflow",route:"/recipes/git-workflow"},{kind:"MdxPage",name:"kubernetes-lens-setup",route:"/recipes/kubernetes-lens-setup"},{kind:"MdxPage",name:"postgres-setup",route:"/recipes/postgres-setup"},{kind:"MdxPage",name:"production-deployment-checklist",route:"/recipes/production-deployment-checklist"},{kind:"MdxPage",name:"sentry-setup",route:"/recipes/sentry-setup"},{kind:"MdxPage",name:"wsl",route:"/recipes/wsl"},{kind:"Meta",data:{alerting:"Alerting","connecting-to-kubernetes":"Connecting to Kubernetes","debug-cluster-connectivity":"Debug Cluster Connectivity","docker-setup":"Docker Setup","editor-setup":"Editor Setup","env-vars-and-secrets":"Env Vars and Secrets","git-workflow":"Git Workflow","kubernetes-lens-setup":"Kubernetes Lens Setup","postgres-setup":"Postgres Setup","production-deployment-checklist":"Production Deployment Checklist","sentry-setup":"Sentry Setup",wsl:"Wsl"}}]},{kind:"Folder",name:"strapi",route:"/strapi",children:[{kind:"MdxPage",name:"general-concepts",route:"/strapi/general-concepts",frontMatter:{sidebar_position:1}},{kind:"MdxPage",name:"load-strapi-db-in-local-dev",route:"/strapi/load-strapi-db-in-local-dev"},{kind:"MdxPage",name:"setup",route:"/strapi/setup",frontMatter:{sidebar_position:2}},{kind:"MdxPage",name:"sync-strapi-db-to-different-env",route:"/strapi/sync-strapi-db-to-different-env"},{kind:"Meta",data:{"general-concepts":"General Concepts","load-strapi-db-in-local-dev":"Load Strapi Db in Local Dev",setup:"Setup","sync-strapi-db-to-different-env":"Sync Strapi Db to Different Env"}}]}],headings:[{type:"heading",depth:1,children:[{type:"text",value:"Connecting to Kubernetes",position:{start:{line:1,column:3,offset:2},end:{line:1,column:27,offset:26}}}],position:{start:{line:1,column:1,offset:0},end:{line:1,column:27,offset:26}},value:"Connecting to Kubernetes"},{type:"heading",depth:2,children:[{type:"text",value:"How to connect to database",position:{start:{line:6,column:4,offset:318},end:{line:6,column:30,offset:344}}}],position:{start:{line:6,column:1,offset:315},end:{line:6,column:30,offset:344}},value:"How to connect to database"},{type:"heading",depth:3,children:[{type:"text",value:"Lens",position:{start:{line:8,column:5,offset:350},end:{line:8,column:9,offset:354}}}],position:{start:{line:8,column:1,offset:346},end:{line:8,column:9,offset:354}},value:"Lens"},{type:"heading",depth:3,children:[{type:"text",value:"kubectl",position:{start:{line:17,column:5,offset:895},end:{line:17,column:12,offset:902}}}],position:{start:{line:17,column:1,offset:891},end:{line:17,column:12,offset:902}},value:"kubectl"},{type:"heading",depth:2,children:[{type:"text",value:"How to see logs",position:{start:{line:27,column:4,offset:1230},end:{line:27,column:19,offset:1245}}}],position:{start:{line:27,column:1,offset:1227},end:{line:27,column:19,offset:1245}},value:"How to see logs"},{type:"heading",depth:3,children:[{type:"text",value:"Lens",position:{start:{line:29,column:5,offset:1251},end:{line:29,column:9,offset:1255}}}],position:{start:{line:29,column:1,offset:1247},end:{line:29,column:9,offset:1255}},value:"Lens"},{type:"heading",depth:3,children:[{type:"text",value:"kubectl",position:{start:{line:33,column:5,offset:1367},end:{line:33,column:12,offset:1374}}}],position:{start:{line:33,column:1,offset:1363},end:{line:33,column:12,offset:1374}},value:"kubectl"},{type:"heading",depth:2,children:[{type:"text",value:"How to connect to app/pod terminal",position:{start:{line:43,column:4,offset:1634},end:{line:43,column:38,offset:1668}}}],position:{start:{line:43,column:1,offset:1631},end:{line:43,column:38,offset:1668}},value:"How to connect to app/pod terminal"},{type:"heading",depth:3,children:[{type:"text",value:"Lens",position:{start:{line:45,column:5,offset:1674},end:{line:45,column:9,offset:1678}}}],position:{start:{line:45,column:1,offset:1670},end:{line:45,column:9,offset:1678}},value:"Lens"},{type:"heading",depth:3,children:[{type:"text",value:"kubectl",position:{start:{line:51,column:5,offset:1876},end:{line:51,column:12,offset:1883}}}],position:{start:{line:51,column:1,offset:1872},end:{line:51,column:12,offset:1883}},value:"kubectl"},{type:"heading",depth:2,children:[{type:"text",value:"Tips & Tricks",position:{start:{line:65,column:4,offset:2399},end:{line:65,column:17,offset:2412}}}],position:{start:{line:65,column:1,offset:2396},end:{line:65,column:17,offset:2412}},value:"Tips & Tricks"},{type:"heading",depth:3,children:[{type:"text",value:"Attach to POD within your terminal without knowing full name",position:{start:{line:69,column:5,offset:2549},end:{line:69,column:65,offset:2609}}}],position:{start:{line:69,column:1,offset:2545},end:{line:69,column:65,offset:2609}},value:"Attach to POD within your terminal without knowing full name"}],flexsearch:{codeblocks:!0}};globalThis.__nextra_internal__={pageMap:c.pageMap,route:c.route};let d="Connecting to Kubernetes";function h(e){let n=Object.assign({h1:"h1",p:"p",code:"code",br:"br",a:"a",h2:"h2",h3:"h3",ol:"ol",li:"li",em:"em",div:"div",pre:"pre",span:"span"},(0,a.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{children:"Connecting to Kubernetes"}),"\n",(0,o.jsxs)(n.p,{children:["This section briefly shows how to do some basic connecting to Service and PODs in kubernetes cluster through ",(0,o.jsx)(n.code,{children:"kubectl"})," or kubernetes Lens.",(0,o.jsx)(n.br,{}),"\n","As stated you will obviously need access to our cluster. To login to specific cluster you can follow our ",(0,o.jsx)(n.a,{href:"./kubernetes-lens-setup",children:"Login guide"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"how-to-connect-to-database",children:"How to connect to database"}),"\n",(0,o.jsx)(n.h3,{id:"lens",children:"Lens"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Open Lens and on the left hand side panel navigate to ",(0,o.jsx)(n.code,{children:"Network -> Services"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Find the Service that you want to connect to, usually something like ",(0,o.jsx)(n.code,{children:"anything-database"})," or ",(0,o.jsx)(n.code,{children:"anything-database-service"})]}),"\n",(0,o.jsxs)(n.li,{children:["Click on right service and scroll down to find Connection section and under there should be a button ",(0,o.jsx)(n.code,{children:"Forward"}),". Click it and choose your local free port"]}),"\n",(0,o.jsx)(n.li,{children:"Now your database should be accessible through localhost"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"Note: it is password free, but if you want to find password to db, go to secrets and find db secret for this db"})}),"\n",(0,o.jsx)(n.h3,{id:"kubectl",children:"kubectl"}),"\n",(0,o.jsxs)(n.p,{children:["You can also port forward directly through ",(0,o.jsx)(n.code,{children:"kubectl"})," command by running"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"kubectl port-forward service/anything-database-service 5432:5432"})})})})}),"\n",(0,o.jsxs)(n.p,{children:["For more information checkout ",(0,o.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/",children:"official port-forward"})," documentation."]}),"\n",(0,o.jsx)(n.h2,{id:"how-to-see-logs",children:"How to see logs"}),"\n",(0,o.jsx)(n.h3,{id:"lens-1",children:"Lens"}),"\n",(0,o.jsxs)(n.p,{children:["You can follow this official video guide on extracting Logs ",(0,o.jsx)(n.a,{href:"https://www.youtube.com/watch?v=QIHqOd05TBA",children:"https://www.youtube.com/watch?v=QIHqOd05TBA"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"kubectl-1",children:"kubectl"}),"\n",(0,o.jsxs)(n.p,{children:["You can get pod logs in you terminal with ",(0,o.jsx)(n.code,{children:"kubectl"})," by running"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"kubectl get logs my-pod"})})})})}),"\n",(0,o.jsxs)(n.p,{children:["For more information, check out ",(0,o.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/cheatsheet/#interacting-with-running-pods",children:"interacting with running pods"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"how-to-connect-to-apppod-terminal",children:"How to connect to app/pod terminal"}),"\n",(0,o.jsx)(n.h3,{id:"lens-2",children:"Lens"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Open Lens and on the left hand side panel navigate to ",(0,o.jsx)(n.code,{children:"Workloads -> Pods"})]}),"\n",(0,o.jsx)(n.li,{children:"Find the POD in question and click on it"}),"\n",(0,o.jsx)(n.li,{children:"Click in right top corner find Pod Shell button (next to Pod Logs)"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"kubectl-2",children:"kubectl"}),"\n",(0,o.jsxs)(n.p,{children:["If you prefer to attach to POD within your terminal, you can do so with ",(0,o.jsx)(n.code,{children:"kubectl"})]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"kubectl "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"exec"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -i -t --namespace "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"namespace"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"pod_name"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" --container "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"container"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -- sh -c "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"clear; (bash || ash || sh)"'})]})})})}),"\n",(0,o.jsxs)(n.p,{children:["For example, to attach to pod with name ",(0,o.jsx)(n.code,{children:'"next-city-gallery-app-debug"'})," in a namespace ",(0,o.jsx)(n.code,{children:'"bratislava-monorepo"'})," and container ",(0,o.jsx)(n.code,{children:'"app"'}),", run the following"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"kubectl "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"exec"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -i -t --namespace bratislava-monorepo next-city-gallery-app-debug --container app -- sh -c "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"clear; (bash || ash || sh)"'})]})})})}),"\n",(0,o.jsx)(n.h2,{id:"tips--tricks",children:"Tips & Tricks"}),"\n",(0,o.jsxs)(n.p,{children:["If you are running reasonable ",(0,o.jsx)(n.code,{children:"*nix"})," terminal you can automate most of these task from your terminal, here are just some examples"]}),"\n",(0,o.jsx)(n.h3,{id:"attach-to-pod-within-your-terminal-without-knowing-full-name",children:"Attach to POD within your terminal without knowing full name"}),"\n",(0,o.jsxs)(n.p,{children:["You can create a simple script, for example ",(0,o.jsx)(n.code,{children:"k8att.sh"}),", that will ",(0,o.jsx)(n.em,{children:"search"})," and attach to the right POD and it's container within your terminal. As this will search through available PODs you don't need to know full name to attach to as sometimes the PODs name can be long and in different namespaces."]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"bash","data-theme":"default",children:[(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"#!/bin/bash"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" [[ "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-z"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$1"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ]]"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"then"})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"echo"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"ERROR: You have to give us name of the pod to attach to"'})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"exit"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" 1"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fi"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"POD_RESP="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"$(kubectl get pods --all-namespaces "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:' grep -E "$1")'})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"POD_NAME="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'$(echo "$POD_RESP" '}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" awk '{print $2}')"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"POD_NAMESPACE="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'$(echo "$POD_RESP" '}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" awk '{print $1}')"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"POD_CONTAINERS="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'$(kubectl get pod --namespace "$POD_NAMESPACE" "$POD_NAME" -o jsonpath=\'{.spec.containers[*].name}\')'})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"IFS="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"' '"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"read"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -ra CONTAINERS "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"<<<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$POD_CONTAINERS"'})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" [ "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"${'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"#"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'CONTAINERS[@]}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"-gt"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" 1 ]"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:";"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"then"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"for"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" i "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"${'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'CONTAINERS[@]}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:";"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"do"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"printf"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%s\\t%s\\n"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$i"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"${CONTAINERS[$i]}"'})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"done"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"read"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -p "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Choose container index (expecting int): "'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" CONTAINER_IX"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    CONTAINER_IX=0"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fi"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"CONTAINER=${CONTAINERS[$CONTAINER_IX]}"})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"echo"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -e "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\"Attaching to pod \\033[0;32m'$POD_NAME'\\033[0m, container \\033[0;32m'$CONTAINER'\\033[0m in \\033[0;34m'$POD_NAMESPACE'\\033[0m namespace \""})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"kubectl "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"exec"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -i -t --namespace "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$POD_NAMESPACE"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$POD_NAME"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" --container "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"$CONTAINER"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" -- sh -c "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"clear; (bash || ash || sh)"'})]})]})})}),"\n",(0,o.jsxs)(n.p,{children:["Then you just ",(0,o.jsx)(n.code,{children:"chmod +x k8att.sh"})," and you can use it to attach. Sticking with our previous attach example, now to attach to a pod ",(0,o.jsx)(n.code,{children:'"next-city-gallery-app-debug"'})," you can just do"]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{"data-language":"bash","data-theme":"default",children:(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"./k8att gallery-app-debug"})})})})}),"\n",(0,o.jsxs)(n.p,{children:["If it has more containers to choose from, the script will prompt you to pick ID of the one that you want to attach to. Script use ",(0,o.jsx)(n.code,{children:"grep"})," extended regex syntax, therefore you can also pass valid regex to it, e.g., ",(0,o.jsx)(n.code,{children:"gallery-[a-z]+-debug"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["A very similar use are ",(0,o.jsx)(n.code,{children:"pod logs"})," for which you can basically use the same script just adjust the last line to ",(0,o.jsx)(n.code,{children:"kubectl get logs"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["You can add these scripts to your aliases in ",(0,o.jsx)(n.code,{children:"~/.bashrc"})," or ",(0,o.jsx)(n.code,{children:"~/.bash_aliases"})]}),"\n",(0,o.jsx)(n.div,{"data-rehype-pretty-code-fragment":"",children:(0,o.jsx)(n.pre,{children:(0,o.jsxs)(n.code,{"data-language":"bash","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"alias"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" k8att="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'~/k8att.sh'"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"alias"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" k8logs="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'~/k8logs.sh'"})]})]})})}),"\n",(0,o.jsx)(n.p,{children:"and just use it as any other command in your workflow."})]})}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}c.title="string"==typeof d&&d||"Connecting to Kubernetes";let u=e=>(0,o.jsx)(r.mK.Provider,{value:e,children:(0,o.jsx)(p,{})});(t=globalThis).__nextra_pageContext__||(t.__nextra_pageContext__=Object.create(null)),globalThis.__nextra_pageContext__["/recipes/connecting-to-kubernetes"]={Content:u,pageOpts:c,themeConfig:i.Z}}},function(e){e.O(0,[9774,5860,2888,179],function(){return e(e.s=1600)}),_N_E=e.O()}]);