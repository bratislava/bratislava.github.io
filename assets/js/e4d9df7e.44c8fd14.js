"use strict";(self.webpackChunkbratislava_github_io=self.webpackChunkbratislava_github_io||[]).push([[6309],{3905:(t,e,a)=>{a.d(e,{Zo:()=>p,kt:()=>f});var n=a(7294);function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function r(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e){if(null==t)return{};var a,n,i=function(t,e){if(null==t)return{};var a,n,i={},o=Object.keys(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||(i[a]=t[a]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)a=o[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}var c=n.createContext({}),s=function(t){var e=n.useContext(c),a=e;return t&&(a="function"==typeof t?t(e):r(r({},e),t)),a},p=function(t){var e=s(t.components);return n.createElement(c.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},d=n.forwardRef((function(t,e){var a=t.components,i=t.mdxType,o=t.originalType,c=t.parentName,p=l(t,["components","mdxType","originalType","parentName"]),d=s(a),f=i,h=d["".concat(c,".").concat(f)]||d[f]||u[f]||o;return a?n.createElement(h,r(r({ref:e},p),{},{components:a})):n.createElement(h,r({ref:e},p))}));function f(t,e){var a=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var o=a.length,r=new Array(o);r[0]=d;var l={};for(var c in e)hasOwnProperty.call(e,c)&&(l[c]=e[c]);l.originalType=t,l.mdxType="string"==typeof t?t:i,r[1]=l;for(var s=2;s<o;s++)r[s]=a[s];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},7587:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var n=a(7462),i=(a(7294),a(3905));const o={},r="Contact Points",l={unversionedId:"recipes/alerting/contact-point",id:"recipes/alerting/contact-point",title:"Contact Points",description:"In this recipe we discuss how to setup a new contact point, so you can better target your alert notification to relevant contacts.",source:"@site/docs/recipes/alerting/contact-point.md",sourceDirName:"recipes/alerting",slug:"/recipes/alerting/contact-point",permalink:"/docs/recipes/alerting/contact-point",draft:!1,editUrl:"https://github.com/bratislava/bratislava.github.io/edit/master/docs/recipes/alerting/contact-point.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Grafana Alerting",permalink:"/docs/recipes/alerting/grafana_alerting"},next:{title:"Alerting on Endpoint Availability or Request Data (HTTP Request)",permalink:"/docs/recipes/alerting/endpoint_alert"}},c={},s=[{value:"Add new Slack channel or chat",id:"add-new-slack-channel-or-chat",level:2},{value:"Add new email address",id:"add-new-email-address",level:2},{value:"Link alerts with a Contact Point",id:"link-alerts-with-a-contact-point",level:2}],p={toc:s};function u(t){let{components:e,...a}=t;return(0,i.kt)("wrapper",(0,n.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"contact-points"},"Contact Points"),(0,i.kt)("p",null,"In this recipe we discuss how to setup a new ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/alerting/contact-points/"},"contact point"),", so you can better target your alert notification to relevant contacts."),(0,i.kt)("p",null,"To whom ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.bratislava.sk/"},"Grafana")," sends the alerts is driven by ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.bratislava.sk/alerting/notifications"},"contact points"),'. You can find the setting in "Alerting" (Bell icon on the left menu) section.'),(0,i.kt)("p",null,"Currently, there are two ways Grafana can send you a alert notification."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A Grafana Bratislava Slack application/bot, that you can add to your channel or create a chat directly"),(0,i.kt)("li",{parentName:"ul"},"Email address ",(0,i.kt)("inlineCode",{parentName:"li"},"grafana[at]devops.bratislava.sk"),", that you can use to send a alert notification to you mailbox")),(0,i.kt)("p",null,"The default setting is to send alerts to Slack Bratislava Innovation Grafana alerting channel. This should serve for most use-case and if you do not wish to change this, you don't need any additional setup when ",(0,i.kt)("a",{parentName:"p",href:"/docs/recipes/alerting/grafana_alerting"},"creating your own alerts"),"."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Note, that not all users can add contact points, you need to be Grafana administrator. If you can't access these ",(0,i.kt)("a",{parentName:"em",href:"https://grafana.bratislava.sk/alerting/notifications"},"notification settings"),", please ask someone from DevOps to add it for you.")),(0,i.kt)("h2",{id:"add-new-slack-channel-or-chat"},"Add new Slack channel or chat"),(0,i.kt)("p",null,"To add a new Slack channel or chat as a contact point, we need to first add Grafana Slack App into the channel/chat."),(0,i.kt)("p",null,"To add Grafana App to the channel"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"We need to open a channel settings and click ",(0,i.kt)("inlineCode",{parentName:"li"},"Integrations")),(0,i.kt)("li",{parentName:"ol"},"There you will see ",(0,i.kt)("inlineCode",{parentName:"li"},'"Add an App"')," button. When clicked, a list of all available application will show up"),(0,i.kt)("li",{parentName:"ol"},"We need to select correct Grafana application. Our application has a description ",(0,i.kt)("inlineCode",{parentName:"li"},'"Grafana @ grafana.bratislava.sk application"'))),(0,i.kt)("p",null,"To be able to receive alerts in a chat"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"You just need to actually start a chat with Grafana App",(0,i.kt)("br",{parentName:"li"}),"You can start it as you would start any other chat with any other person and just type into ",(0,i.kt)("inlineCode",{parentName:"li"},'"To:"'),' field "Grafana" ')),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Note, that the application is only part of Bratislava Innovation group and your channel needs to be part of it also.")),(0,i.kt)("p",null,"If you have successfully integrated Grafana into your channel/chat, then it is rest is very straight forward. "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"In ",(0,i.kt)("a",{parentName:"li",href:"https://grafana.bratislava.sk/alerting/notifications"},"Grafana's notification settings")," click ",(0,i.kt)("inlineCode",{parentName:"li"},'"+ New contact point"')," button"),(0,i.kt)("li",{parentName:"ol"},"Give it a name, like ",(0,i.kt)("inlineCode",{parentName:"li"},'"Slack - <name of the channel>"')," or ",(0,i.kt)("inlineCode",{parentName:"li"},'"Slack - <name of the person>"')," in case of a chat, e.g., ",(0,i.kt)("inlineCode",{parentName:"li"},'"Slack - DevOps"')," or ",(0,i.kt)("inlineCode",{parentName:"li"},'"Slack - jozko.mrkvicka"')),(0,i.kt)("li",{parentName:"ol"},'Select a contact point type to "Slack"'),(0,i.kt)("li",{parentName:"ol"},"Specify recipient, by either giving the name of the channel or name of the person in case of chat or respective Slack IDs. You can find the Slack ID in the channel/chat settings."),(0,i.kt)("li",{parentName:"ol"},"Give it a Bot token. If you are administrator of the App you can find the token in ",(0,i.kt)("a",{parentName:"li",href:"https://api.slack.com/apps/A0429S9L3E3/oauth"},"Grafana App Settings"),", if not, ask somebody from DevOps to provide a token for you.")),(0,i.kt)("p",null,"And that's it. You have successfully added a new contact point into Grafana, you can test it by hitting ",(0,i.kt)("inlineCode",{parentName:"p"},'"Test"')," button.  "),(0,i.kt)("p",null,'If you want to receive specific alerts on this channel you will also need to create a notification policy to match those alerts. You can look at "Link alerts with a contact point" section.'),(0,i.kt)("h2",{id:"add-new-email-address"},"Add new email address"),(0,i.kt)("p",null,"Grafana email alerting is setup through our ",(0,i.kt)("a",{parentName:"p",href:"https://www.mailgun.com/"},"mailgun")," smtp server with address ",(0,i.kt)("inlineCode",{parentName:"p"},"grafana[at]devops.bratislava.sk"),". "),(0,i.kt)("p",null,"To add an email contact point, we need to "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Visit  Grafana alerting ",(0,i.kt)("a",{parentName:"li",href:"https://grafana.bratislava.sk/alerting/notifications"},"notification settings")),(0,i.kt)("li",{parentName:"ol"},"Click ",(0,i.kt)("inlineCode",{parentName:"li"},'"+ New contact point"')," button"),(0,i.kt)("li",{parentName:"ol"},"Give it a name, like ",(0,i.kt)("inlineCode",{parentName:"li"},'"Email - <address>"')," or ",(0,i.kt)("inlineCode",{parentName:"li"},'"Email - <project>"')),(0,i.kt)("li",{parentName:"ol"},"Specify email addresses to which to send notifications")),(0,i.kt)("p",null,"And that's it. Grafana should be sending alert notification, you can test it by hitting ",(0,i.kt)("inlineCode",{parentName:"p"},'"Test"')," button."),(0,i.kt)("p",null,'If you want to receive specific alerts on this email you will also need to create a notification policy to match those alerts. You can look at "Link alerts with a contact point" section.'),(0,i.kt)("h2",{id:"link-alerts-with-a-contact-point"},"Link alerts with a Contact Point"),(0,i.kt)("p",null,"Setting up a ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/alerting/contact-points/"},"contact point")," is just a half of the work. If you want to send specific alerts to specific contacts, you need to also setup a ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/alerting/notifications/"},'"Notification Policy"'),". You can find it in alerting section (Bell icon on the left menu), under ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.bratislava.sk/alerting/routes"},'"Notification policies"'),"."),(0,i.kt)("p",null,"To build a notification policy we need to "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},'First hit the "+ New notification policy" button'),(0,i.kt)("li",{parentName:"ol"},'Add a matcher. This will create rules, based on which we will "match" or link specific alerts with your contact point')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'- Hit "+ Add matcher" button\n- Add as many label conditions as you need, to match only that group of alerts that you need\n')),(0,i.kt)("ol",{start:3},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select a contact point")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"(Optional) You can also setup a ",(0,i.kt)("a",{parentName:"p",href:"https://grafana.com/docs/grafana/latest/alerting/notifications/mute-timings/"},'"Mute Timing"'),' or if there are already some, you can choose one. This will "mute" alert notification based on specified conditions. For example, you might want to receive alerts only during your working hours, so you would create a mute timing that would pause notifications during your off time. '),(0,i.kt)("p",{parentName:"li"},"And that's it. Now you have linked your contact point with your policy and should be receiving alert notifications."))))}u.isMDXComponent=!0}}]);