"use strict";(self.webpackChunkbratislava_github_io=self.webpackChunkbratislava_github_io||[]).push([[6666],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>d});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var o=r.createContext({}),c=function(e){var t=r.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=c(e.components);return r.createElement(o.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=c(a),d=n,m=h["".concat(o,".").concat(d)]||h[d]||u[d]||i;return a?r.createElement(m,s(s({ref:t},p),{},{components:a})):r.createElement(m,s({ref:t},p))}));function d(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,s=new Array(i);s[0]=h;var l={};for(var o in t)hasOwnProperty.call(t,o)&&(l[o]=t[o]);l.originalType=e,l.mdxType="string"==typeof e?e:n,s[1]=l;for(var c=2;c<i;c++)s[c]=a[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},3495:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var r=a(7462),n=(a(7294),a(3905));const i={},s="Meilisearch setup",l={unversionedId:"bratislava.sk/meilisearch-setup",id:"bratislava.sk/meilisearch-setup",title:"Meilisearch setup",description:"If you are looking to run a Meilisearch instance locally look to the Meilisearch part of the docs. If you don't need to change the search configuration and need the search results only to work on the frontend code, connecting to staging meilisearch instance - https://bratislava-strapi-meilisearch.staging.bratislava.sk - works reasonably well (beware, though, that this will not reflect your local data if used alongside local Strapi instance).",source:"@site/docs/bratislava.sk/meilisearch-setup.md",sourceDirName:"bratislava.sk",slug:"/bratislava.sk/meilisearch-setup",permalink:"/docs/bratislava.sk/meilisearch-setup",draft:!1,editUrl:"https://github.com/bratislava/bratislava.github.io/edit/master/docs/bratislava.sk/meilisearch-setup.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Forms",permalink:"/docs/bratislava.sk/forms"},next:{title:"Meilisearch",permalink:"/docs/meilisearch"}},o={},c=[{value:"Meilisearch <code>MASTER_KEY</code> location",id:"meilisearch-master_key-location",level:3},{value:"Index settings",id:"index-settings",level:3}],p={toc:c};function u(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,r.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"meilisearch-setup"},"Meilisearch setup"),(0,n.kt)("p",null,"If you are looking to run a Meilisearch instance locally look to the ",(0,n.kt)("a",{parentName:"p",href:"/docs/meilisearch"},"Meilisearch")," part of the docs. If you don't need to change the search configuration and need the search results only to work on the frontend code, connecting to staging meilisearch instance - ",(0,n.kt)("a",{parentName:"p",href:"https://bratislava-strapi-meilisearch.staging.bratislava.sk"},"https://bratislava-strapi-meilisearch.staging.bratislava.sk")," - works reasonably well (beware, though, that this will not reflect your local data if used alongside local Strapi instance)."),(0,n.kt)("p",null,"On each of our instances the following manual index setup is required - this needs to be done after both the Strapi and Meilisearch instances are up and running. Read more on this topic in the ",(0,n.kt)("a",{parentName:"p",href:"/docs/meilisearch"},"Meilisearch")," section of the docs."),(0,n.kt)("p",null,"The following content types need to be indexed in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/meilisearch/strapi-plugin-meilisearch"},"meilisearch-strapi-plugin"),": ",(0,n.kt)("inlineCode",{parentName:"p"},"blog-post"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"page"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"vzn")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Meilisearch plugin screenshot",src:a(2471).Z,width:"1914",height:"902"})),(0,n.kt)("h3",{id:"meilisearch-master_key-location"},"Meilisearch ",(0,n.kt)("inlineCode",{parentName:"h3"},"MASTER_KEY")," location"),(0,n.kt)("p",null,"Find ",(0,n.kt)("inlineCode",{parentName:"p"},"{meilisearch-secret-name}")," which can be found in project folder ",(0,n.kt)("inlineCode",{parentName:"p"},'strapi -> kubernetes -> base -> secrets -> {meilisearch-file-name}.secret.{env}.yml -> metadata -> name in our case "bratislava-strapi-meilisearch-secret"')),(0,n.kt)("p",null,(0,n.kt)("a",{parentName:"p",href:"https://bratislava.github.io/docs/recipes/kubernetes-lens-setup"},"Log in")," to k8 and open Lense and head to ",(0,n.kt)("inlineCode",{parentName:"p"},'Config -> Secrets -> find {meili-secret-name} in our case "bratislava-strapi-meilisearch-secret"')),(0,n.kt)("h3",{id:"index-settings"},"Index settings"),(0,n.kt)("p",null,"Additionaly the following index setup is required (replace the instance and the MASTER_KEY as needed, the instance below is for production meilisearch server):"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'curl --request PATCH \\\n  --url https://bratislava-strapi-meilisearch.bratislava.sk/indexes/vzn/settings \\\n  --header \'Authorization: Bearer MASTER_KEY\' \\\n  --header \'Content-Type: application/json\' \\\n  --data \'{\n    "sortableAttributes": ["title","validFrom", "publishedAt"]\n}\'\n')),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"curl --request PATCH \\\n  --url https://bratislava-strapi-meilisearch.bratislava.sk/indexes/blog-post/settings \\\n  --header 'Authorization: Bearer MASTER_KEY' \\\n  --header 'Content-Type: application/json' \\\n  --data '{\n    \"sortableAttributes\": [\"title\", \"publishedAt\"]\n}'\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"curl --request PATCH \\\n  --url https://bratislava-strapi-meilisearch.bratislava.sk/indexes/blog-post/settings \\\n  --header 'Authorization: Bearer MASTER_KEY' \\\n  --header 'Content-Type: application/json' \\\n  --data '{\n    \"filterableAttributes\": [\"locale\"]\n}'\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"curl --request PATCH \\\n  --url https://bratislava-strapi-meilisearch.bratislava.sk/indexes/page/settings \\\n  --header 'Authorization: Bearer MASTER_KEY' \\\n  --header 'Content-Type: application/json' \\\n  --data '{\n    \"filterableAttributes\": [\"locale\"]\n}'\n")))}u.isMDXComponent=!0},2471:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/meili-plugin-94f4b87ee11b06327602321b0f33927e.png"}}]);